<div class="flex-1-1-100 right border p-2 ml-2 d-flex flex-column w-100">
    <h5 class="flex-0-0-auto">Báo cáo theo thời gian phục vụ</h5>
    <div class="filter d-flex flex-0-0-auto mt-2">
        <app-date-range-picker-filter [opens]="'right'" class="mr-1" [startDate]="dateFrom" [endDate]="dateTo"
            (searchChange)="onSearchDateChange($event)"></app-date-range-picker-filter>
        <kendo-combobox class="mr-1" [placeholder]="'Bác sĩ'" [valueField]="'id'" [textField]="'name'"
            [filterable]="true" #employeeCbx [data]="listEmployee" (selectionChange)="onSelectEmployee($event)">
        </kendo-combobox>
        <kendo-combobox width="auto" [placeholder]="'Tất cả chi nhánh'"
            class="mr-1" [valueField]="'id'" [textField]="'name'" [filterable]="true"
            [data]="listCompany" (selectionChange)="onSelectCompany($event)" #companyCbx>
        </kendo-combobox>
        <button class="btn btn-primary" (click)="onExcelExport()"><i class="fas fa-download"></i> Xuất Excel</button>
        <input type="text" [(ngModel)]="search" (ngModelChange)="this.searchUpdate.next($event)"
            placeholder="Tìm kiếm theo mã, tên, số điện thoại khách hàng"
            class="ml-auto form-control w-50">
    </div>
    <div class="filter d-flex flex-0-0-auto mt-2 time-filter-wrapper">
        <button type="button" *ngFor="let time of filterTimes" class="btn active mr-1" (click)="setStateFilter(time)"
            [class.btn-primary]="timeStart == time.timeStart" >
            {{time.text}} <span class="badge badge-light bg-white" [class.bac-white]="timeStart == time.timeStart">{{timeCount[time.timeStart] || 0}}</span>
        </button>
    </div>
    <div class="o_content mt-2">
        <div class="o_dashboard_view">
            <div>
                <kendo-grid #grid [data]="gridData" [pageSize]="limit"
                    [skip]="skip" [pageable]="true" [loading]="loading" (pageChange)="pageChange($event)">
                    <kendo-grid-column title="Ngày tiếp nhận" width="100">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{dataItem.dateWaiting | date:'shortDate'}}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="Khách hàng" width="120">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <a class="text-primary" title="Xem hồ sơ khách hàng"
                                [routerLink]="['/partners/customer/' + dataItem.partner.id]">
                                {{dataItem.partner?.name}}
                            </a>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="Dịch vụ" width="120">
                        <ng-template kendoGridCellTemplate let-dataItem>                      
                            <span isEllipsisActive class="d-inline-block text-truncate">
                                {{dataItem.products}}
                            </span>                         
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="Bác sĩ" width="100">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{dataItem.doctorName}}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="Loại khám" width="100">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{getExamination(dataItem.isRepeatCustomer)}}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="Thời gian phục vụ" width="100">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{dataItem.minuteTotal ? getMinute(dataItem.minuteTotal) : '' }}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="Thời gian chờ khám" width="100">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{dataItem.minuteWaiting ? getMinute(dataItem.minuteWaiting) : '' }}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column title="Thời gian khám" width="100">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{dataItem.minuteExamination ? getMinute(dataItem.minuteExamination) : ''}}
                        </ng-template>
                    </kendo-grid-column>
                </kendo-grid>
            </div>
        </div>
    </div>

</div>