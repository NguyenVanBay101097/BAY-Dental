<div class="t_section_right">
    <div class="t_treatment_wrapper">
        <div class="o_cp_controller">
            <div class="o_control_panel">
                <div class="breadcrumb">
                    <div class="d-flex align-items-center">
                        <div style="font-size: 1rem;" class="mr-2">Chế độ xem</div>
                        <select [(ngModel)]="viewType" (change)="onChangeViewType()" class="form-control w-auto mr-1">
                            <option value="saleOrder">Phiếu điều trị</option>
                            <option value="saleOrderLine">Dịch vụ</option>
                        </select>
                    </div>
                    <div class="d-flex">
                        <app-date-range-picker-filter [opens]="'right'" [startDate]="dateFrom" [endDate]="dateTo" (searchChange)="onSearchDateChange($event)"></app-date-range-picker-filter>
                        <button type="button" (click)="createNewSaleOrder()" class="ml-2 btn btn-primary"><i
                            class="fas fa-plus"></i> Thêm phiếu điều trị</button>
                    </div>
                </div>
                <div class="o_searchview w-50">
                    <input type="text" class="o_searchview_input" placeholder="Tìm kiếm theo số phiếu điều trị" [(ngModel)]="search" (ngModelChange)="this.searchUpdate.next($event)" />
                    <span class="o_searchview_icon fas fa-search"></span>
                </div>
                <div class="o_cp_left">
                    <div class="o_cp_buttons">

                    </div>
                    <div class="o_cp_sidebar">
                    </div>
                </div>
                <div class="o_cp_right">

                </div>
            </div>
        </div>
        <div class="t_treatment_grid">
            <div class="kendo-grid-data">
                <kendo-grid *ngIf="viewType == 'saleOrder'" [data]="saleOrdersData" [pageable]="pagerSettings" [pageSize]="limit" [skip]="skip" (pageChange)="pageChange($event)" [resizable]="true" [loading]="loading">
                    <kendo-grid-column [headerStyle]="{'color': 'black', 'font-weight':'600','line-height': '1em'}" field="Name" title="Số phiếu" width="100">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <a class="text-primary" (click)="getFormSaleOrder(dataItem.id)">{{dataItem.name}}</a>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column [headerStyle]="{'color': 'black','font-weight':'600','line-height': '1em'}" field="DateOrder" title="Ngày lập phiếu" width="120">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{dataItem.dateOrder | date:'short'}}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column class="text-right" [headerStyle]="{'color': 'black','font-weight':'600','line-height': '1em'}" field="AmountTotal" title="Tổng tiền" width="120">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{dataItem.amountTotal | number}}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column class="text-right" [headerStyle]="{'color': 'black','font-weight':'600','line-height': '1em'}" title="Thanh Toán" width="120">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{ (dataItem.amountTotal - dataItem.residual) | number }}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column class="text-right" [headerStyle]="{'color': 'black','font-weight':'600','line-height': '1em'}" field="Residual" title="Còn lại" width="120">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            {{dataItem.residual | number}}
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column [headerStyle]="{'color': 'black','font-weight':'600','line-height': '1em'}" field="State" title="Trạng thái" width="100">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <span *ngIf="dataItem.state === 'draft'">Nháp</span>
                            <span *ngIf="dataItem.state === 'done'">Hoàn thành</span>
                            <span *ngIf="dataItem.state === 'sale'">Đang điều trị</span>
                        </ng-template>
                    </kendo-grid-column>
                    <kendo-grid-column [headerStyle]="{'color': 'black','font-weight':'600','line-height': '1em'}" title="#" width="40">
                        <ng-template kendoGridCellTemplate let-dataItem>
                            <button type="button" class="btn btn-icon btn-light" (click)="deleteItem(dataItem)">
                                <span class="k-icon k-i-delete"></span>
                            </button>
                        </ng-template>
                    </kendo-grid-column>
                    <div *kendoGridDetailTemplate="let dataItem">
                        <app-partner-customer-treatment-sale-order-line [saleOrderId]="dataItem.id">
                        </app-partner-customer-treatment-sale-order-line>
                    </div>
                </kendo-grid>

                <kendo-grid-data *ngIf="viewType == 'saleOrderLine'">
                    <kendo-grid-column title="Dịch vụ"></kendo-grid-column>
                    <kendo-grid-column title="Ngày tạo"></kendo-grid-column>
                    <kendo-grid-column title="Răng"></kendo-grid-column>
                    <kendo-grid-column title="Chẩn đoán"></kendo-grid-column>
                    <kendo-grid-column title="Bác sĩ"></kendo-grid-column>
                    <kendo-grid-column title="Số lượng"></kendo-grid-column>
                    <kendo-grid-column title="Thành tiền"></kendo-grid-column>
                    <kendo-grid-column title="Thanh toán"></kendo-grid-column>
                    <kendo-grid-column title="Còn lại"></kendo-grid-column>
                    <kendo-grid-column title="Trạng thái"></kendo-grid-column>
                </kendo-grid-data>
            </div>
        </div>
       
    </div>
</div>